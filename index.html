<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Disaster Early Warning Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
      color: #333;
    }
    h1 { text-align: center; color: #2c3e50; }
    .container { max-width: 600px; margin: 0 auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 15px; font-weight: bold; }
    select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    .result { margin-top: 20px; padding: 15px; border-radius: 8px; background: #eaf2f8; }
    .risk-high { color: red; font-weight: bold; }
    .risk-medium { color: orange; font-weight: bold; }
    .risk-low { color: green; font-weight: bold; }
  </style>
</head>
<body>

  <h1>Disaster Early Warning Dashboard</h1>

  <div class="container">
    <label for="state">Select State:</label>
    <select id="state">
      <option value="">-- Select State --</option>
      <option value="Assam">Assam</option>
      <option value="Delhi">Delhi</option>
      <option value="Maharashtra">Maharashtra</option>
      <option value="Kerala">Kerala</option>
      <option value="Tamil Nadu">Tamil Nadu</option>
      <option value="Odisha">Odisha</option>
      <option value="West Bengal">West Bengal</option>
      <option value="Gujarat">Gujarat</option>
      <option value="Rajasthan">Rajasthan</option>
      <option value="Manipur">Manipur</option>
      <option value="Goa">Goa</option>
      <option value="Chhattisgarh">Chhattisgarh</option>
      <option value="Arunachal Pradesh">Arunachal Pradesh</option>
      <option value="Andhra Pradesh">Andhra Pradesh</option>
      <option value="Karnataka">Karnataka</option>
    </select>

    <label for="disaster">Select Disaster Type:</label>
    <select id="disaster">
      <option value="">-- Select Disaster --</option>
      <option value="flood">Flood</option>
      <option value="cyclone">Cyclone</option>
      <option value="earthquake">Earthquake</option>
      <option value="heatwave">Heatwave</option>
      <option value="landslide">Landslide</option>
    </select>

    <button id="fetchBtn">Get Disaster Risk</button>

    <div class="result" id="result" style="display:none;">
      <h2>Risk Details</h2>
      <p><strong>Risk Percentage:</strong> <span id="risk"></span></p>
      <p><strong>Confidence:</strong> <span id="confidence"></span></p>
      <p><strong>HF Semantic Score:</strong> <span id="hf"></span></p>
      <p><strong>Weather:</strong> <span id="weather"></span></p>
      <p><strong>Recommendations:</strong> <span id="recommendations"></span></p>
      <p><small>Sources: <span id="sources"></span></small></p>
      <p><small>Calculation Time: <span id="time"></span></small></p>
    </div>
  </div>

  <script>
    const btn = document.getElementById("fetchBtn");
    const resultDiv = document.getElementById("result");

    btn.addEventListener("click", async () => {
      const state = document.getElementById("state").value;
      const disaster = document.getElementById("disaster").value;

      if (!state || !disaster) {
        alert("Please select both state and disaster type.");
        return;
      }

      try {
        const res = await fetch(`https://hackathon-test-production-36d0.up.railway.app/predict/${encodeURIComponent(state)}?disaster_type=${disaster}`);
        if (!res.ok) throw new Error("API request failed");
        const data = await res.json();

        resultDiv.style.display = "block";

        // Risk color coding
        let riskClass = "risk-low";
        if (data.risk_percentage > 70) riskClass = "risk-high";
        else if (data.risk_percentage > 40) riskClass = "risk-medium";

        document.getElementById("risk").innerHTML = `<span class="${riskClass}">${data.risk_percentage}%</span>`;
        document.getElementById("confidence").textContent = data.confidence;
        document.getElementById("hf").textContent = data.hf_semantic_score;
        document.getElementById("weather").textContent = `Temp: ${data.weather.temperature}Â°C, Humidity: ${data.weather.humidity}%, Precipitation: ${data.weather.precipitation}, Wind Speed: ${data.weather.wind_speed} m/s`;
        document.getElementById("recommendations").textContent = data.recommendations.join(", ");
        document.getElementById("sources").textContent = data.details.sources;
        document.getElementById("time").textContent = data.details.calculation_time;

      } catch (err) {
        alert("Error fetching data: " + err.message);
      }
    });
  </script>

</body>
</html>
